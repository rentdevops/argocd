apiVersion: apps/v1
kind: Deployment
metadata:
  name: lantan-queue
spec:
  replicas: 1  
  selector:
    matchLabels:
      app: lantan-queue
  template:
    metadata:
      labels:
        app: lantan-queue
    spec:
      containers:
      - name: lantan-queue
        image: registry.digitalocean.com/lantan/lantan-backend:dev-320
        command: ["php", "/var/www/artisan", "queue:work", "--verbose", "--tries=3", "--timeout=180"]
        envFrom:
          - configMapRef:
              name: lantan-env
          - secretRef:
              name: app-secrets
        volumeMounts:
          - name: env-file
            mountPath: /var/www/.env  
            subPath: .env

      volumes:
        - name: env-file
          configMap:
            name: lantan-env  # This is the ConfigMap created above for .env

      imagePullSecrets:
        - name: do-secret






























# apiVersion: apps/v1
# kind: Deployment
# metadata:
#   name: lantan-queue
# spec:
#   replicas: 1  
#   selector:
#     matchLabels:
#       app: lantan-queue
#   template:
#     metadata:
#       labels:
#         app: lantan-queue
#     spec:
#       containers:
#       - name: lantan-queue
#         image: registry.digitalocean.com/lantan/lantan-backend:dev-320
#         command: ["php", "/var/www/artisan", "queue:work", "--verbose", "--tries=3", "--timeout=180"]
#         envFrom:
#           - configMapRef:
#               name: lantan-config
#           - secretRef:
#               name: app-secrets

#         env:
#         - name: APP_ENV
#           value: "staging"
#         - name: QUEUE_CONNECTION
#           value: "database"

